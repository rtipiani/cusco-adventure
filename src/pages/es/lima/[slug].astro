---
import Layout from "../../../layouts/Layout.astro";
import { paquetes } from "../../../data/es/paquetes-lima";

const lang: "es" | "en" = "es";

export async function getStaticPaths() {
	return paquetes.map((p) => ({
		params: { slug: p.slug },
		props: { paquete: p },
	}));
}

const { paquete } = Astro.props;

function t(value: string | { es: string; en: string }) {
  	return typeof value === "string" ? value : value[lang];
}
---

<Layout>
    <section class="relative">
		<div class="relative h-[70vh] md:h-[80vh] rounded-b-3xl overflow-hidden shadow-lg">
			<img src={paquete.imagen} alt={typeof paquete.titulo === "string" ? paquete.titulo : paquete.titulo[lang]} class="absolute inset-0 w-full h-full object-cover" />
			<div class="absolute inset-0 bg-gradient-to-b from-black/70 via-black/60 to-black/70"></div>
			<div class="absolute inset-0 flex flex-col items-center justify-center text-center px-6">
				<h1 class="font-extrabold text-white drop-shadow-lg text-[clamp(1.8rem,4vw,3.2rem)]">
					{typeof paquete.titulo === "string" ? paquete.titulo : paquete.titulo[lang]}
				</h1>
				<p class="mt-3 text-white/80 max-w-2xl text-[clamp(0.9rem,2vw,1.2rem)]">
					{typeof paquete.descripcion === "string" ? paquete.descripcion : paquete.descripcion[lang]}
				</p>
				<div class="mt-6 flex flex-col sm:flex-row gap-3 w-full sm:w-auto">
					<a href={`https://wa.me/51973291892?text=${encodeURIComponent(`Hola, estoy interesado en el tour ${typeof paquete.titulo === "string" ? paquete.titulo : paquete.titulo[lang]}`)}`} target="_blank" rel="noopener noreferrer" class="w-full sm:w-auto bg-white/90 text-green-800 px-6 py-3 rounded-xl shadow hover:bg-white transition">
						{lang === "es" ? "Reservar ahora" : "Book now"}
					</a>
				</div>
			</div>
		</div>
	</section>

    <section class="py-16 bg-gray-50">
        <div class="max-w-5xl mx-auto px-6">
            {paquete.itinerario ? (
                <div class="bg-white shadow rounded-lg p-6 space-y-6">
                    <h2 class="text-2xl font-bold text-green-800">Itinerario Completo</h2>

                    <p class="text-gray-700 font-medium">
                        {typeof paquete.itinerario.horarios === "string" ? paquete.itinerario.horarios  : paquete.itinerario.horarios[lang]}
                    </p>

                    <div class="space-y-4">
                        {Array.isArray(paquete.itinerario.detalle) ? (
                            paquete.itinerario.detalle.map((parrafo) => (
                            <p class="text-gray-700 leading-relaxed text-justify">{parrafo}</p>
                        ))
                        ) : (
                            <p class="text-gray-700 leading-relaxed text-justify">
                                {paquete.itinerario.detalle}
                            </p>
                        )}
                    </div>

                    {paquete.itinerario.incluye && (
                        <div class="bg-gray-50 p-6 rounded-xl border border-green-200 shadow-md">
                            <h3 class="text-xl font-semibold text-green-800 flex items-center gap-2">
                                <i class="fa-solid fa-circle-check text-green-600"></i>
                                Incluye
                            </h3>
                            <ul class="mt-4 space-y-2 text-gray-700">
                                {paquete.itinerario.incluye.map((item) => (
                                    <li class="flex items-start gap-2 text-base">
                                        <i class="fa-solid fa-check text-green-600 mt-1"></i>
                                        <span>{item}</span>
                                    </li>
                                ))}
                            </ul>
                        </div>
                    )}

                    {paquete.itinerario.noIncluye && (
                        <div class="bg-gray-50 p-6 rounded-xl border border-red-200 shadow-md">
                            <h3 class="text-xl font-semibold text-red-800 flex items-center gap-2">
                                <i class="fa-solid fa-circle-xmark text-red-600"></i>
                                No Incluye
                            </h3>
                            <ul class="mt-4 space-y-2 text-gray-700">
                                {paquete.itinerario.noIncluye.map((item) => (
                                    <li class="flex items-start gap-2 text-base">
                                        <i class="fa-solid fa-xmark text-red-600 mt-1"></i>
                                        <span>{item}</span>
                                    </li>
                                ))}
                            </ul>
                        </div>
                    )}
                </div>
            ) : (
                <p class="text-gray-600">
                    Este tour no tiene un itinerario detallado disponible en este momento.
                </p>
            )}

            <div class="mt-12 text-center">
                <a href="/es/lima" class="inline-block bg-green-800 text-white px-6 py-3 rounded-lg shadow hover:bg-green-700 transition">
                    <i class="fas fa-arrow-left mr-2"></i>Volver a Tours
                </a>
            </div>
        </div>
    </section>
</Layout>